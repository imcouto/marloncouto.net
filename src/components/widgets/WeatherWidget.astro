---
import { Card, CardContent, CardHeader, CardTitle } from '@/components/ui/card';
import { mockWeatherData } from '@/helpers/data.ts';
import { GET as getWeather } from '@/pages/api/weather.ts';
import type { WeatherData } from '@/types/index.ts';
import { Cloud, CloudRain, Snowflake, Sun } from 'lucide-react';

const weatherIcons = {
  sunny: Sun,
  cloudy: Cloud,
  rainy: CloudRain,
  snowy: Snowflake,
};

const res = await getWeather(Astro);
const data = await res.json();
if (data?.error) {
  console.error(data.error);
}

const weatherData: WeatherData = mockWeatherData;
console.log('weatherData :>> ', weatherData);

const WeatherIcon = weatherIcons[weatherData.condition];
---

<Card className='w-full max-w-sm mx-auto'>
  <CardHeader>
    <CardTitle className='flex justify-between items-center'>
      <span>Clima Atual</span>
      <WeatherIcon className='w-8 h-8' />
    </CardTitle>
  </CardHeader>
  <CardContent>
    <div class='text-4xl font-bold mb-2'>
      {weatherData.temperature}Â°C
    </div>
    <div class='text-muted-foreground'>{weatherData.location}</div>
  </CardContent>
</Card>
